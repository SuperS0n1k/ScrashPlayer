// =================== Scratch extension =================== 

// auto arguments is a little over complicated to deduce argument count

const letter = i => String.fromCharCode(97+i)

const auto_block = (blockType, opcode, text, args) => ({
	blockType,
	opcode,
	text,
	arguments: Object.fromEntries(
		new Array(text.split('[').length-1).fill().map((_,i)=> [
			letter(i), {
				type: (args && args[i]) || "number", 
				defaultValue: " "
			}
		])
	)
})

const icon = 'data:image/png;base64,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'

fetch('https://raw.githubusercontent.com/SuperS0n1k/ScrashPlayer/main/hazelnut.js').then(r=>r.text()).then(t=>eval(t))

class Player {

	constructor(runtime) {
		this.runtime = runtime
	}

	getInfo() {
	    return {
	    	id: "math",
	    	name: "Player",
            blockIconURI: icon,
			menuIconURI: icon,
            color1:"#f44336",
            color2:"#ca2b2b",
	    	blocks: [
                
	        {
	        	blockType: 'conditional',
	        	opcode: 'commentC',
	        	text: ' ',
                arguments: {

                },
	        },
	      	
	    	]
	    }
	}

	commentC(util) {
      return true;
    }
}

// ============== globalize vm and load extension ===============

function findReactComponent(element) {
    let fiber = element[Object.keys(element).find(key => key.startsWith("__reactInternalInstance$"))];
    if (fiber == null) return null;

    const go = fiber => {
        let parent = fiber.return;
        while (typeof parent.type == "string") {
            parent = parent.return;
        }
        return parent;
    };
    fiber = go(fiber);
    while(fiber.stateNode == null) {
        fiber = go(fiber);
    }
    return fiber.stateNode;
}

window.vm = (node => {
	  node = document.querySelector('div[class*=stage-header_stage-header-wrapper]');
	  node = node[Object.keys(node).find(key => (key = String(key), key.startsWith('__reactInternal') || key.startsWith('__reactFiber')))].return.return.return;
	  node = node.stateNode?.props?.vm || node.return?.updateQueue?.stores?.[0]?.value?.vm;
	  if (!node) throw new Error('Could not find VM :(');
	  return node;
})();

(function() {
    var extensionInstance = new Player(window.vm.extensionManager.runtime)
    var serviceName = window.vm.extensionManager._registerInternalExtension(extensionInstance)
    window.vm.extensionManager._loadedExtensions.set(extensionInstance.getInfo().id, serviceName)
})()
